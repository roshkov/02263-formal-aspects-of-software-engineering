\documentclass[a4]{article}
\usepackage[total={6.7in,10.2in}, % text area width and height
		    top=1in, left=1in, right=1in, bottom=1in,% top and left margin
		    includefoot]{geometry}
\usepackage{rsllisting}
\lstset{language=rsl}

\title{Course 02263 Mandatory Assignment 2, 2018} 

\author{Marc Storm Larsen (s144452),\\ 
        Mario Padilla Carrion (s172387)}

\begin{document}

\maketitle

\tableofcontents
\newpage

\section{Work distribution}

\section{Introduction}
This document contains a solution to the problem of representing tram nets and tram time tables with data types, furthermore will the document describe a number of functions that can be used to check whether concrete values of the data types to describe the net and time table satisfies a number of requirements, making them wellformed.

\section{Formal Specification of Nets}

\lstinputlisting{assignment-2/src/NET.rsl}

\noindent Below are the requirements for a \emph{net} defined. These are the requirement that a \emph{net} has to fulfil in order to be considered wellformed. Each requirement will indicate what function is used to ensure the requirement. \\

\begin{description}
    \item[isWellformed] \hfill
        \begin{itemize}
            \item The \emph{net} must contain at least two \emph{stops}. Function: \verb=hasCorrectSize=.
            \item Any \emph{stop} must have a direct or indirect connection to every other \emph{stop} in the \emph{net}, i.e. a tram can travel to any \emph{stop} from any \emph{stop}. Function: \verb=isNetConnected=.
            \item A \emph{stop} can not have a direct \emph{connection} to itself. Function: \verb=noDirectSelfConnections=.
            \item A \emph{stop} can not have more than one direct \emph{connection} to the same \emph{stop}. Function: \verb=hasOneDirectConnection=.
            \item A \emph{connection} between two \emph{stops} consists of two tracks, one track for each direction, i.e. a tram can travel back and forth between the two \emph{stops} using the same \emph{connection}. Function: \verb=hasBiDirectConnection=.
        \end{itemize}
\end{description}

\noindent In the list below one will find a description of all the functions. If one of the functions utilised the functionality of another, it will be stated in the end of the description. \\

\begin{description}
    \item[hasCorrectSize] \hfill \\ Can be used to check whether or not a \emph{net} has a correct size, i.e. the number of \emph{stops} in the \emph{net}.
    \item[isNetConnected] Can be used to check that the \emph{net} is connected, i.e. there is a direct or indirect \emph{connection} from any \emph{stop} to all other \emph{stops}. Function: \verb=areConnected=.
    \item[noDirectSelfConnections] \hfill \\ Can be used to check that any \emph{stop} in the \emph{net} does not have a direct \emph{connection} to itself. Function: \verb=areDirectlyConnected=.
    \item[hasOneDirectConnection] \hfill \\ Can be used to check if any \emph{stop} in the \emph{net} only has one direct \emph{connection} to another \emph{stop}. Function:  \verb=Connections=.
    \item[hasBiDirectConnection] \hfill \\ Can be used to check that all direct \emph{connections} between two \emph{stops} in the \emph{net} are connecting the \emph{stops} in both directions. Function: \verb=areDirectlyConnected=.
    \item[isIn] \hfill \\ Can be used to check whether or not a \emph{stop} is in a \emph{net}.
    \item[capacity - stop] \hfill \\ Can be used to find out what the capacity of a \emph{stop} is.
    \item[areDirectlyConnected] \hfill \\ Can be used to check whether or not two \emph{stops} are directly connected in a \emph{net}. Function: \verb=hasDirectConnection=.
    \item[minHeadway] \hfill \\ Can be used to find out what the minimum \emph{headway} between two connected \emph{stops} is. Function: \verb=getConnection=.
    \item[capacity - connection] \hfill \\ Can be used to find out what the capacity of a \emph{connection} is. Function: \verb=getConnection=.
    \item[minDrivingTime] \hfill \\ Can be used to find out what the minimum driving time between two connected \emph{stops} is. Function: \verb=getConnection=.
    % Our own observer functions
    \item[getConnection] \hfill \\ Can be used to get the \emph{connection} between two directly connected \emph{stops}. Function: \verb=filterConnections=.
    \item[filterConnections] \hfill \\ Can be used to find a single \emph{connection} in a set of connections.
    \item[hasDirectConnection] \hfill \\ Can be used to check if two \emph{stops} are directly connected in one direction in a \emph{net}.
    \item[areConnected] Can be used to check if two \emph{stops} are connected, either with a direct or indirect \emph{connection}.
\end{description}  

\section{Formal Specification of Time Tables}

\lstinputlisting{assignment-2/src/TIMETABLE.rsl}

It is assumed that two consecutive rows in a time table for a tram is implying that a tram is driving from stop $x$ to $y$ without passing any intermediate stops. Furthermore should the times in a timetable always be in increasing order.

\begin{description}
    \item[isWellformed] To the say that a \emph{Time Table} is wellformed, means that is should fulfil the following requirements.
        \begin{itemize}
            \item All times in a \emph{time table} must be equal or increasing, i.e. a tram can not travel back in time. Function: \verb=hasCorrectTimes=
            \item All stops that is a part of a \emph{time table} must be part of the \emph{net}. Function: \verb=allStopsInNet=
            \item Any two consecutive rows in a \emph{time table} implies that the \emph{tram} is driving directly between the \emph{stops} on a direct connection, the direct connection should therefore exists in the \emph{net}. Function: \verb=noIndirectConnections=
            \item The capacity of any \emph{stop} in the \emph{net} must not be exceeded. Function: \verb=noStopCapacityExceeded=
            \item The capacity of any \emph{connection} in either direction in the \emph{net} must not be exceeded. Function: \verb=noConnectionCapacityExceeded=
            \item The time between two \emph{trams} arriving and departing from a \emph{stop} must not be shorter then the headway of the connection they were arriving and departing from. Function: \verb=noHeadwayViolation=
            \item Any \emph{tram} is not allowed to drive faster on a connection between two \emph{stops} than the connection allows. Function: \verb=noDrivingTimeExceeded=
        \end{itemize}
\end{description}

\begin{description}
    \item[hasCorrectTimes] \hfill \\ This function can be used to check that all times in a timetable are equal or increasing. 
    \item[allStopsInNet] \hfill \\ 
    \item[noIndirectConnections] \hfill \\ 
    \item[noStopCapacityExceeded] \hfill \\ 
    \item[noConnectionCapacityExceeded] \hfill \\ 
    \item[noHeadwayViolation - list] \hfill \\ 
    \item[noHeadwayViolation] \hfill \\
\end{description}

% ------------ GENERATORS ------------
\begin{description}
    \item[createScheduleConn] \hfill \\ 
    \item[createScheduleConnRec] \hfill \\ 
    \item[createScheduleConnForTimeSlots] \hfill \\ 
    \item[insertScheduleSlot - connection] \hfill \\ 
    \item[createScheduleStop] \hfill \\ 
    \item[createScheduleStopRec] \hfill \\ 
    \item[createScheduleStopForTimeSlots] \hfill \\ 
    \item[insertScheduleSlot - stop] \hfill \\ 
\end{description}

% ------------ OBSERVERS ------------
\begin{description}
    \item[isIn] \hfill \\ 
    \item[isInSchedule - Stop] \hfill \\ 
    \item[isInSchedule - Connection] \hfill \\ 
    \item[findMaxCapacity] \hfill \\ 
    \item[findMaxCapacityRec] \hfill \\ 
    \item[sort] \hfill \\ 
    \item[getLargerItems] \hfill \\
    \item[getSmallerItems] \hfill \\
    \item[isSorted] \hfill \\ 
\end{description}

\section{Testing the Specifications}

\subsection{Nets}

\lstinputlisting{assignment-2/src/NETTest.rsl}

\subsection{Time Tables}

\lstinputlisting{assignment-2/src/TIMETABLETest.rsl}

\section{Testing by translation to SML}

\subsection{Test specification}

The purpose of each individual test has been added as source code comments and can be seen in the content of the \verb=NetTest.rsl=  and \verb=TIMETABLETest.rsl= files, which are shown above. The tests have been divided into three sections, corresponding to \emph{Generators, Observers and Predicates} with their respective auxiliary functions, to increase the readability. \\

The general idea of the approach to test the "atomic"/individual functions, have been as follows. For the functions that returns a \verb=Bool=, we have created test data for the test cases, where we expect the result to be true. However, the focus has mainly been on creating invalid test data, that will test the robustness of the functions, that are test cases where we expect the result to be false. As for the functions that return something else than \verb=Bool=. Here has there also been created test data for test cases, where the result has been compared to the expected output, to get a truth value in the overview of the test results, which can be seen in the following section. The test data created for these functions have both been best case test data, where everything is as it should be, but also some of the test data has not been best case, to for example test wrong Nets generated with for example \emph{Connections} between \emph{Stops} that are not part of the \emph{Net}.


\subsection{Results of evaluations}

\end{document}
